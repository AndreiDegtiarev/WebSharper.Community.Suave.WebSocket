(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;a=window;b=a.WebSharper=a.WebSharper||{};c=b.UI=b.UI||{};d=c.Next=c.Next||{};e=d.CSharp=d.CSharp||{};f=e.ViewExtensions=e.ViewExtensions||{};g=e.DocExtension=e.DocExtension||{};h=e.Client=e.Client||{};i=h.Helpers=h.Helpers||{};j=h.RouteMapBuilder=h.RouteMapBuilder||{};k=h.RouteItemParsers=h.RouteItemParsers||{};l=d&&d.View;m=d&&d.Doc;n=d&&d.Var;o=b&&b.List;p=a.IntelliFactory;q=p&&p.Runtime;r=d&&d.RouteMap;s=b&&b.Seq;t=b&&b.Unchecked;u=b&&b.Arrays;v=b&&b.Collections;w=v&&v.FSharpMap;x=b&&b.Option;y=v&&v.Map;z=b&&b.Nullable;A=b&&b.Operators;f.UpdateWhile=function(B,C,D){return l.UpdateWhile(C,D,B);};g.DocSeqCached=function(B,C,D){var E;E=function(F,G){return D(F,G);};return m.ConvertSeqBy(C,function(F){return function(G){return E(F,G);};},B);};i.seqRefToListRef=function(B){var C;C=function(D,E){return E;};return n.Lens(B,o.ofSeq,function(D,E){return C(D,E);});};j=h.RouteMapBuilder=q.Class({Install:function(){var B,C,D,E;B=this.ToRouteMap();C=r.Install(B);D=(E=function(F,G){return F(function(H){return n.Set(C,H);},G);},function(F){return o.map(function(G){return function(H){return E(G,H);};},F);}(o.rev(this.renders)));return m.BindView(function(F){return s.pick(function(G){return G(F);},D);},C.v);},ToRouteMap:function(){var B,C;B=o.rev(this.links);C=o.rev(this.routes);return r.CreateWithQuery(function(D){return s.pick(function(E){return E(D);},B);},function(D){return s.pick(function(E){return E(D);},C);});},AddRender:function(B){this.renders=new o.T({$:1,$0:B,$1:this.renders});},AddLink:function(B){this.links=new o.T({$:1,$0:B,$1:this.links});},AddRoute:function(B){this.routes=new o.T({$:1,$0:B,$1:this.routes});}},null,j);j.New=q.Ctor(function(){this.links=new o.T({$:0});this.routes=new o.T({$:0});this.renders=new o.T({$:0});},j);k["System.Double"]=function(B){var C,D,E;C=B[0];return C.$==1?(D=(new a.RegExp("^[0-9](?:\\.[0-9]*)?$")).exec(C.$0),t.Equals(D,null)?null:{$:1,$0:[(E=u.get(D,0),a.parseFloat(E)),C.$1]}):null;};k["System.Int32"]=function(B){var C,D,E;C=B[0];return C.$==1?(D=(new a.RegExp("^[0-9]+$")).exec(C.$0),t.Equals(D,null)?null:{$:1,$0:[(E=u.get(D,0),a.parseInt(E,a.$1)),C.$1]}):null;};k["System.String"]=function(B){var C;C=B[0];return C.$==1?{$:1,$0:[C.$0,C.$1]}:null;};k.MakeLink=function(B){return function(C){var D,E,F,G,H,I;return B.$==1?(D=[new w.New([])],[o.append(x.toList(B.$1),o.ofSeq((E=function(J,K,L,M){var N,O,P,Q;return t.Equals(K,0)?(N=M(C[J]),(D[0]=y.FoldBack(function(R,S,T){return T.Add(R,S);},N[1],D[0]),N[0])):t.Equals(K,1)?(O=o.head((M(C[J]))[0]),(D[0]=D[0].Add(J,O),new o.T({$:0}))):t.Equals(K,2)?(P=C[J],(P!=null?P.$==1:false)?D[0]=D[0].Add(J,o.head((M(P.$0))[0])):void 0,new o.T({$:0})):t.Equals(K,3)?(Q=C[J],(Q!=null?D[0]=D[0].Add(J,o.head((M(z.get(Q)))[0])):void 0,new o.T({$:0}))):A.FailWith("invalid QueryItem enum value");},function(J){return s.collect(function(K){return E(K[0],K[1],K[2],K[3]);},J);}(B.$2)))),D[0]]):B.$==2?[new o.T({$:1,$0:a.String(s.length(C)),$1:o.ofSeq((F=(G=B.$2,(H=function(J){return J[0];},function(J){return H(G(J));})),function(J){return s.collect(F,J);}(C)))}),new w.New([])]:B.$==3?[o.ofSeq(s.concat(((I=function(J,K){return function(L){return(K(L))[0];};},(q.Curried3(s.map2))(function(J,K){return(function(L){return I(L[0],L[1]);}(J))(K);}))(B.$0))(C))),new w.New([])]:[o.ofArray([a.String(C)]),new w.New([])];};};k.ParseRoute=function(B){var C,D,E;C=k.ParseShape(B);D=(E=function(F,G){return G.$==0?{$:1,$0:F}:null;},function(F){return F==null?null:E.apply(null,F.$0);});return function(F){return D(C(F));};};k.ParseShape=function(B){return function(C){var D,E,F,G,H,I,J,K,L;function M(N,O,P){var Q,R,S;Q=N();R=function(T){return[Q,T];};return function(T){return T==null?null:{$:1,$0:R(T.$0)};}(((S=function(T,U){var V,W,X,Y,Z,_0,_1,_2,_3,_4;V=U[0];W=U[1];X=U[2];return(T!=null?T.$==1:false)?(Y=T.$0,t.Equals(W,0)?(Z=X([Y,E]),(Z!=null?Z.$==1:false)?(Q[V]=Z.$0[0],{$:1,$0:Z.$0[1]}):null):t.Equals(W,1)?(_0=y.TryFind(V,E),_0==null?null:(Q[V]=_0.$0,{$:1,$0:Y})):t.Equals(W,2)?(_1=y.TryFind(V,E),(_1!=null?_1.$==1:false)?(_2=X([o.ofArray([_1.$0]),new w.New([])]),(_2!=null?_2.$==1:false)?(Q[V]={$:1,$0:_2.$0[0]},{$:1,$0:Y}):null):(Q[V]=null,{$:1,$0:Y})):t.Equals(W,3)?(_3=y.TryFind(V,E),(_3!=null?_3.$==1:false)?(_4=X([o.ofArray([_3.$0]),new w.New([])]),(_4!=null?_4.$==1:false)?(Q[V]=_4.$0[0],{$:1,$0:Y}):null):(Q[V]=null,{$:1,$0:Y})):A.FailWith("invalid QueryItem enum value")):null;},(q.Curried3(u.fold))(S))({$:1,$0:O}))(P));}D=C[0];E=C[1];return B.$==1?B.$1==null?M(B.$0,D,B.$2):(D.$==1?D.$0===B.$1.$0?(F=[D.$1,D.$0],true):false:false)?M(B.$0,F[0],B.$2):null:B.$==2?(G=B.$0,(H=B.$1,(I=function(N,O){var P;P=u.create(N,null);return function(Q,R){var S;while(true)if(Q===N)return{$:1,$0:[G(P),R]};else{S=H([R,E]);if(S!=null?S.$==1:false){u.set(P,Q,S.$0[0]);Q=Q+1;R=S.$0[1];}else return null;}}(0,O);},function(N){return N==null?null:I.apply(null,N.$0);}(k["System.Int32"]([D,E]))))):B.$==3?(J=a.Array.prototype.constructor.apply(a.Array,[]),(K=function(N){return[J,N];},function(N){return N==null?null:{$:1,$0:K(N.$0)};}(((L=function(N,O){var P,Q;P=O[0];Q=function(R){var S;S=function(T,U){var V;V=J.push(T);return U;};return function(T){return T==null?null:{$:1,$0:S.apply(null,T.$0)};}(P([R,E]));};return function(R){return R==null?null:Q(R.$0);}(N);},(q.Curried3(u.fold))(L))({$:1,$0:D}))(B.$0)))):B.$0([D,E]);};};}());
